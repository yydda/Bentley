# 日记系统 - "吾日三省吾身"产品设计文档

## 一、产品定位

**核心目标**：帮助用户通过每日结构化反思，实现自我觉察、目标对齐和关系维护，而非简单的"记账式"记录。

**设计原则**：
- 每日填写时间控制在 5-10 分钟
- 引导式问题，而非开放式填空
- 强调"为什么"和"如何改进"，而非仅记录"做了什么"
- 通过周期复盘发现模式和趋势

---

## 二、信息架构重构

### 2.1 从"四大模块"到"三省模型"

**原架构**：时间花销 / LIFE / AM / LOVE（记账式）

**新架构**：省身 / 省事 / 省人（反思式）

```
┌─────────────────────────────────────────┐
│           每日三省吾身                    │
├─────────────────────────────────────────┤
│ 第一步：省身（Self）                      │
│   - 我对自己负责了吗？                    │
│   - 身体、心情、成长                      │
├─────────────────────────────────────────┤
│ 第二步：省事（Work/Actions）              │
│   - 我在做的事，是否对目标有推进？        │
│   - 时间、目标、产出                      │
├─────────────────────────────────────────┤
│ 第三步：省人（Relationships）             │
│   - 我对他人和关系负责了吗？              │
│   - 关系、贡献、内耗                      │
└─────────────────────────────────────────┘
```

---

## 三、详细字段设计

### 第一步：省身（Self）- 我对自己负责了吗？

#### 3.1.1 身体与精力

| 字段名 | 类型 | 必填 | 说明 | 引导问题 |
|--------|------|------|------|----------|
| 睡眠时长 | 数字（小时，0.5步进） | ✅ | 0-24小时 | "昨晚睡了多久？" |
| 睡眠质量 | 评分（1-5星） | ✅ | 表情选择：😴😑😐😊😴 | "睡得怎么样？" |
| 运动情况 | 文本（简短） | ❌ | 50字以内 | "今天有运动吗？" |
| 精力水平 | 评分（1-5） | ✅ | 滑条 | "今天整体精力如何？" |
| 疲劳原因 | 多选 | ❌ | 选项：工作/社交/情绪/其他 | "如果疲劳，主要因为什么？" |

#### 3.1.2 心情与情绪

| 字段名 | 类型 | 必填 | 说明 | 引导问题 |
|--------|------|------|------|----------|
| 今日心情 | 评分（1-5） | ✅ | 表情：😢😐😊😄🤩 | "今天整体心情如何？" |
| 高光时刻 | 文本（一句话） | ❌ | 100字以内 | "今天最开心/满足的一刻是什么？" |
| 低谷时刻 | 文本（一句话） | ❌ | 100字以内 | "今天最难受/沮丧的一刻是什么？" |
| 情绪关键词 | 多选 | ❌ | 选项：焦虑/平静/兴奋/疲惫/满足/失落 | "今天的主要情绪是？" |

#### 3.1.3 学习与成长

| 字段名 | 类型 | 必填 | 说明 | 引导问题 |
|--------|------|------|------|----------|
| 今日学习 | 文本（简短） | ❌ | 100字以内 | "今天学到了什么新东西？" |
| 成长瞬间 | 文本（简短） | ❌ | 100字以内 | "今天有没有做一件对未来的自己有帮助的事？" |
| 自我觉察 | 文本（中等） | ❌ | 200字以内 | "今天什么事情最消耗你？为什么？" |

**第一步总结问题**（必填）：
- "今天，我对自己负责了吗？" → 文本（200字以内）

---

### 第二步：省事（Work/Actions）- 我在做的事，是否对目标有推进？

#### 3.2.1 时间分配（保留原有逻辑，但优化）

| 字段名 | 类型 | 必填 | 说明 | 引导问题 |
|--------|------|------|------|----------|
| 主职工作 | 数字（小时） | ✅ | 0-24，0.5步进 | "主职工作花了多少时间？" |
| 副业/项目 | 数字（小时） | ✅ | 0-24，0.5步进 | "副业/个人项目花了多少时间？" |
| 学习/成长 | 数字（小时） | ✅ | 0-24，0.5步进 | "学习/自我提升花了多少时间？" |
| 娱乐/放松 | 数字（小时） | ✅ | 0-24，0.5步进 | "娱乐/放松花了多少时间？" |
| 社交/关系 | 数字（小时） | ✅ | 0-24，0.5步进 | "社交/维护关系花了多少时间？" |
| 通勤/杂事 | 数字（小时） | ✅ | 0-24，0.5步进 | "通勤/杂事花了多少时间？" |
| 睡眠 | 数字（小时） | ✅ | 0-24，0.5步进 | "睡眠时间（与省身模块同步）" |

**时间分配提示**：
- 自动计算总和，必须等于24小时
- 突出显示"目标相关时间"（主职+副业+学习）vs "非目标时间"（娱乐+通勤+杂事）

#### 3.2.2 目标与产出

| 字段名 | 类型 | 必填 | 说明 | 引导问题 |
|--------|------|------|------|----------|
| 今日MIT | 文本（一句话） | ✅ | 100字以内 | "今天最重要的一件事是什么？" |
| MIT完成度 | 评分（0-100%） | ✅ | 滑条 | "完成了吗？完成度多少？" |
| 未完成原因 | 文本（简短） | ❌ | 100字以内 | "如果没完成，真实原因是什么？" |
| 今日产出 | 文本（中等） | ❌ | 200字以内 | "今天最值得被写进履历/作品集的一件事是什么？" |
| 效率自评 | 评分（1-5） | ✅ | 滑条 | "今天做的事情中，有多少是'有效'而非'忙碌'？" |

#### 3.2.3 项目进度（保留AM模块核心）

| 字段名 | 类型 | 必填 | 说明 | 引导问题 |
|--------|------|------|------|----------|
| 项目进度 | 评分（0-100%） | ❌ | 滑条 | "主要项目进度如何？" |
| 工作反思 | 文本（中等） | ❌ | 300字以内 | "今天的工作反思和知识整理" |

**第二步总结问题**（必填）：
- "今天，我在做的事是否对目标有推进？" → 文本（200字以内）

---

### 第三步：省人（Relationships）- 我对他人和关系负责了吗？

#### 3.3.1 关键关系

| 字段名 | 类型 | 必填 | 说明 | 引导问题 |
|--------|------|------|------|----------|
| 与父母互动 | 文本（简短） | ❌ | 100字以内 | "今天和父母有互动吗？" |
| 与伴侣互动 | 文本（简短） | ❌ | 100字以内 | "今天和伴侣有互动吗？" |
| 与朋友互动 | 文本（简短） | ❌ | 100字以内 | "今天和朋友有互动吗？" |
| 关系质量 | 评分（1-5） | ❌ | 滑条 | "今天的关系质量如何？" |

#### 3.3.2 贡献与帮助

| 字段名 | 类型 | 必填 | 说明 | 引导问题 |
|--------|------|------|------|----------|
| 帮助他人 | 文本（简短） | ❌ | 100字以内 | "今天有没有帮到谁？哪怕是很小的事" |
| 新连接 | 数字 | ❌ | 整数 | "今天建立了几个新连接？" |
| 有效互动量 | 数字 | ❌ | 整数 | "今天有意义的互动有多少次？" |

#### 3.3.3 内耗与冲突（保留LIFE模块核心，但优化结构）

| 字段名 | 类型 | 必填 | 说明 | 引导问题 |
|--------|------|------|------|----------|
| 内耗记录 | 数组（对象） | ❌ | 可添加多条 | "今天有没有情绪卡点？" |

**内耗记录对象结构**：
```javascript
{
  事件: "文本（100字）",
  我的反应: "文本（100字）",
  真实感受: "文本（100字）",
  更好的做法: "文本（100字）",
  是否解决: "是/否"
}
```

**第三步总结问题**（必填）：
- "今天，我对他人和关系负责了吗？" → 文本（200字以内）

---

### 第四步：明日计划（承诺式，而非To-do）

| 字段名 | 类型 | 必填 | 说明 | 引导问题 |
|--------|------|------|------|----------|
| 明日MIT（最多3项） | 数组（对象） | ✅ | 3项以内 | "明天最重要的一件事是什么？" |

**明日MIT对象结构**：
```javascript
{
  任务: "文本（100字）",
  重要性原因: "下拉选择：收入/健康/关系/成长/心理",
  预计时间: "数字（小时）"
}
```

**明日承诺**（必填）：
- "如果明天重来，我会怎么过？" → 文本（200字以内）

---

### 第五步：每日三省（固定三问，形成修炼主线）

| 问题 | 类型 | 必填 | 说明 |
|------|------|------|------|
| 我今天在"动机"上有偏差吗？ | 文本（200字） | ✅ | "有没有哪件事，其实只是为了迎合别人/逃避不适，而不是出于真正的愿望？" |
| 我今天在哪个瞬间，和自己理想的样子不一致？ | 文本（200字） | ✅ | "那一刻，你理想中的自己会怎么做？" |
| 如果明天重来，我会怎么过？ | 文本（200字） | ✅ | "用2-3句描述理想的一天安排（时间+重点+心态）" |

---

## 四、页面流程设计

### 4.1 主流程（每日填写）

```
┌─────────────────────────────────────┐
│  顶部导航栏                          │
│  [日期选择] [历史] [导出] [保存] [预览] │
└─────────────────────────────────────┘
           ↓
┌─────────────────────────────────────┐
│  步骤指示器（5步）                   │
│  [省身] [省事] [省人] [明日] [三省]  │
│  进度条：20% / 40% / 60% / 80% / 100%│
└─────────────────────────────────────┘
           ↓
┌─────────────────────────────────────┐
│  当前步骤内容卡片                     │
│  ┌─────────────────────────────┐   │
│  │ 步骤标题 + 日期              │   │
│  ├─────────────────────────────┤   │
│  │ 引导问题区域                │   │
│  │ "我对自己负责了吗？"        │   │
│  ├─────────────────────────────┤   │
│  │ 表单字段（分组展示）        │   │
│  │ - 身体与精力                │   │
│  │ - 心情与情绪                │   │
│  │ - 学习与成长                │   │
│  ├─────────────────────────────┤   │
│  │ 总结问题（必填）            │   │
│  │ "今天，我对自己负责了吗？"  │   │
│  └─────────────────────────────┘   │
└─────────────────────────────────────┘
           ↓
┌─────────────────────────────────────┐
│  底部导航                            │
│  [← 上一步]        [下一步 →]        │
└─────────────────────────────────────┘
```

### 4.2 步骤详情

#### 步骤1：省身（Self）
- **分组1：身体与精力**（折叠面板，默认展开）
  - 睡眠时长、睡眠质量、运动情况、精力水平、疲劳原因
- **分组2：心情与情绪**（折叠面板，默认展开）
  - 今日心情、高光时刻、低谷时刻、情绪关键词
- **分组3：学习与成长**（折叠面板，默认折叠）
  - 今日学习、成长瞬间、自我觉察
- **总结问题**（必填，大文本框）

#### 步骤2：省事（Work/Actions）
- **分组1：时间分配**（折叠面板，默认展开）
  - 7个时间字段，自动计算总和，必须=24小时
  - 显示"目标相关时间"占比
- **分组2：目标与产出**（折叠面板，默认展开）
  - 今日MIT、完成度、未完成原因、今日产出、效率自评
- **分组3：项目进度**（折叠面板，默认折叠）
  - 项目进度、工作反思
- **总结问题**（必填，大文本框）

#### 步骤3：省人（Relationships）
- **分组1：关键关系**（折叠面板，默认展开）
  - 与父母/伴侣/朋友互动、关系质量
- **分组2：贡献与帮助**（折叠面板，默认展开）
  - 帮助他人、新连接、有效互动量
- **分组3：内耗与冲突**（折叠面板，默认折叠）
  - 内耗记录（可添加多条，每条包含：事件/反应/感受/做法/是否解决）
- **总结问题**（必填，大文本框）

#### 步骤4：明日计划
- **明日MIT**（最多3项，每项包含：任务/重要性原因/预计时间）
- **明日承诺**（必填，大文本框）

#### 步骤5：每日三省（固定三问）
- **问题1**：动机偏差（必填，大文本框）
- **问题2**：理想不一致（必填，大文本框）
- **问题3**：理想的一天（必填，大文本框）

---

## 五、周/月复盘功能

### 5.1 周复盘（新增页面/弹窗）

**触发方式**：
- 每周日自动提示
- 或手动点击"周复盘"按钮

**内容结构**：

#### 5.1.1 数据概览（自动生成）
- 本周平均心情：😊 4.2/5
- 本周平均睡眠：7.5小时
- 本周平均精力：3.8/5
- 本周目标相关时间占比：65%
- 本周记录完整度：6/7天

#### 5.1.2 本周高光三件事（手动填写）
- 文本（每项100字以内）

#### 5.1.3 本周最困扰的一个问题（手动填写）
- 文本（200字以内）

#### 5.1.4 本周内耗分析（自动生成）
- 内耗次数：3次
- 主要内耗类型：工作压力、关系冲突
- 解决率：66%

#### 5.1.5 下周要尝试的一个新习惯（手动填写）
- 文本（100字以内）

#### 5.1.6 下周MIT（手动填写，最多3项）
- 同"明日计划"结构

### 5.2 月视图（新增页面）

**触发方式**：
- 点击"历史"按钮，切换到"月视图"标签

**内容结构**：
- **日历热力图**：显示每日记录完整度（颜色深浅）
- **本月数据趋势**：
  - 心情折线图（7天平均）
  - 睡眠时长折线图（7天平均）
  - 目标相关时间占比折线图（7天平均）
- **本月三个问题**（手动填写）：
  1. 这个月，你最骄傲的一件事？（200字）
  2. 这个月，最想改进的一件习惯？（200字）
  3. 下个月，你想成为一个怎样的人？（200字，一句话画像）

---

## 六、数据模型

### 6.1 每日记录数据结构

```javascript
{
  date: "2024-01-15", // 日期
  updatedAt: "2024-01-15T23:30:00Z", // 更新时间
  
  // 第一步：省身
  省身: {
    身体与精力: {
      睡眠时长: 7.5,
      睡眠质量: 4, // 1-5
      运动情况: "跑步30分钟",
      精力水平: 4, // 1-5
      疲劳原因: ["工作", "情绪"]
    },
    心情与情绪: {
      今日心情: 4, // 1-5
      高光时刻: "完成了项目里程碑",
      低谷时刻: "和同事有争执",
      情绪关键词: ["焦虑", "满足"]
    },
    学习与成长: {
      今日学习: "学习了Vue3的新特性",
      成长瞬间: "主动承担了团队的一个难题",
      自我觉察: "今天最消耗我的是无意义的会议"
    },
    总结: "今天对自己负责了，但睡眠不足，需要调整" // 必填
  },
  
  // 第二步：省事
  省事: {
    时间分配: {
      主职工作: 8,
      副业项目: 2,
      学习成长: 1,
      娱乐放松: 2,
      社交关系: 1,
      通勤杂事: 1.5,
      睡眠: 8.5 // 与省身模块同步
    },
    目标与产出: {
      今日MIT: "完成项目文档",
      MIT完成度: 80, // 0-100%
      未完成原因: "时间估算不足",
      今日产出: "完成了核心功能开发",
      效率自评: 4 // 1-5
    },
    项目进度: {
      项目进度: 75, // 0-100%
      工作反思: "今天效率不错，但需要更好的时间规划"
    },
    总结: "今天对目标有推进，但效率还可以更高" // 必填
  },
  
  // 第三步：省人
  省人: {
    关键关系: {
      与父母互动: "晚上打了电话",
      与伴侣互动: "一起吃了晚饭",
      与朋友互动: "和A聊了工作",
      关系质量: 4 // 1-5
    },
    贡献与帮助: {
      帮助他人: "帮同事解决了技术问题",
      新连接数: 1,
      有效互动量: 3
    },
    内耗与冲突: [
      {
        事件: "和同事意见不合",
        我的反应: "情绪激动，直接反驳",
        真实感受: "觉得不被尊重",
        更好的做法: "先倾听，再表达观点",
        是否解决: true
      }
    ],
    总结: "今天关系维护得不错，但需要控制情绪" // 必填
  },
  
  // 第四步：明日计划
  明日计划: {
    MIT: [
      {
        任务: "完成项目测试",
        重要性原因: "收入",
        预计时间: 4
      },
      {
        任务: "运动30分钟",
        重要性原因: "健康",
        预计时间: 0.5
      }
    ],
    承诺: "明天要更专注，减少干扰，早睡早起" // 必填
  },
  
  // 第五步：每日三省
  每日三省: {
    动机偏差: "今天开会时，我其实不想发言，但为了表现而说了很多，这不是真正的我",
    理想不一致: "和同事争执时，我理想中的自己会冷静沟通，而不是情绪化",
    理想的一天: "早上6点起床，运动30分钟，专注工作4小时，下午学习2小时，晚上和家人共度时光，10点前睡觉"
  }
}
```

### 6.2 周复盘数据结构

```javascript
{
  周开始日期: "2024-01-08",
  周结束日期: "2024-01-14",
  创建时间: "2024-01-14T23:00:00Z",
  
  数据概览: {
    平均心情: 4.2,
    平均睡眠: 7.5,
    平均精力: 3.8,
    目标相关时间占比: 65,
    记录完整度: 6 // 6/7天
  },
  
  本周高光: [
    "完成了项目第一阶段",
    "和父母深度沟通了一次",
    "学会了新技能"
  ],
  
  本周困扰: "工作压力大，睡眠不足",
  
  内耗分析: {
    内耗次数: 3,
    主要类型: ["工作压力", "关系冲突"],
    解决率: 66
  },
  
  下周新习惯: "每天10点前睡觉",
  
  下周MIT: [
    { 任务: "...", 重要性原因: "...", 预计时间: ... }
  ]
}
```

### 6.3 月复盘数据结构

```javascript
{
  月份: "2024-01",
  创建时间: "2024-01-31T23:00:00Z",
  
  日历数据: {
    "2024-01-01": { 完整度: 1 }, // 1=完整，0.5=部分，0=未记录
    "2024-01-02": { 完整度: 1 },
    // ...
  },
  
  数据趋势: {
    心情: [4.2, 4.0, 4.5, ...], // 7天平均数组
    睡眠: [7.5, 7.0, 8.0, ...],
    目标相关时间占比: [65, 70, 60, ...]
  },
  
  本月骄傲: "完成了年度目标的第一季度任务",
  本月改进: "要养成早睡早起的习惯",
  下月画像: "一个更自律、更专注、更健康的人"
}
```

---

## 七、交互优化

### 7.1 填写体验优化

1. **智能填充**：
   - 睡眠时长自动从"省身"同步到"省事"的时间分配
   - 前一天的习惯/MIT可一键复制到今日

2. **必填字段提示**：
   - 未填写必填字段时，下一步按钮显示"请先完成必填项"
   - 必填字段用红色星号标记

3. **实时保存**：
   - 每完成一个字段，自动保存（防抖1秒）
   - 切换步骤时，自动保存当前步骤数据

4. **引导提示**：
   - 每个分组上方显示"💡 提示：..."
   - 长文本字段下方显示"建议：..."

### 7.2 预览与复盘

1. **预览弹窗优化**：
   - 显示今日三省的回答（高亮）
   - 显示今日数据与本周平均的对比
   - 显示"昨日MIT完成情况"

2. **周复盘入口**：
   - 每周日自动弹出提示
   - 或在"历史"页面显示"本周复盘"按钮

3. **月视图入口**：
   - "历史"页面增加"月视图"标签
   - 显示日历热力图和数据趋势

---

## 八、Gamification优化

### 8.1 成就系统（保留并优化）

- **连续记录**：连续7天、30天、100天
- **习惯连击**：连续早睡3天、连续运动7天
- **内耗减少**：本周内耗次数 < 上周
- **目标达成**：连续7天MIT完成度 > 80%
- **关系维护**：连续7天关系质量 > 4

### 8.2 数据反馈

- **趋势提醒**：
  - "你连续3天心情偏低，建议..."
  - "你连续5天睡眠不足，建议..."
  - "本周目标相关时间占比提升10%，很棒！"

---

## 九、实施优先级

### Phase 1：核心功能（MVP）
1. 重构三大步骤（省身/省事/省人）
2. 实现字段和表单
3. 实现数据保存和加载
4. 实现预览功能

### Phase 2：增强功能
1. 实现"明日计划"和"每日三省"
2. 实现周复盘功能
3. 优化预览和总览

### Phase 3：高级功能
1. 实现月视图和月复盘
2. 实现数据趋势分析
3. 实现年度主题功能

---

## 十、迁移方案

### 10.1 数据兼容

保留原有数据结构，新增字段采用"合并"策略：

```javascript
// 旧数据
{
  时间花销: { 主职: 8, ... },
  LIFE: { 习惯: [...], ... },
  AM: { 项目进度: 75, ... },
  LOVE: { 新连接数: 1, ... }
}

// 新数据（兼容旧数据）
{
  省身: { ... },
  省事: {
    时间分配: { 主职工作: 8, ... }, // 映射自 时间花销
    项目进度: { 项目进度: 75, ... } // 映射自 AM
  },
  省人: {
    贡献与帮助: { 新连接数: 1, ... }, // 映射自 LOVE
    内耗与冲突: [...] // 映射自 LIFE.内耗
  },
  // 保留旧字段，用于兼容
  时间花销: { ... },
  LIFE: { ... },
  AM: { ... },
  LOVE: { ... }
}
```

### 10.2 迁移脚本

在`src/utils/migration.js`中实现数据迁移函数，将旧数据转换为新格式。

---

## 十一、UI/UX设计要点

1. **步骤指示器**：使用Element Plus的`el-steps`，5步显示
2. **分组展示**：使用`el-collapse`折叠面板，默认展开重要分组
3. **引导问题**：每个分组上方显示大号引导问题
4. **总结问题**：使用大文本框，占位符提示格式
5. **明日MIT**：使用卡片式布局，每项可展开编辑
6. **每日三省**：使用大卡片，每问独立卡片，突出重要性

---

## 十二、后续迭代方向

1. **AI辅助**：根据历史数据，AI生成周/月总结建议
2. **社交功能**：匿名分享"本周高光"，形成社区
3. **目标对齐**：年度主题功能，每日/周/月复盘都回到主题
4. **数据导出**：支持导出为Markdown、PDF、Excel
5. **提醒功能**：每日填写提醒、周复盘提醒

