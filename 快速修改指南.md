# 快速修改功能指南

## 🎯 常见修改场景

### 场景1：添加新的时间分类（如"运动"）

**需要修改的文件**：
1. `src/utils/storage.js` - 添加新字段到默认数据
2. `src/components/TimeSpend.vue` - 添加输入框
3. `src/utils/export.js` - 添加导出逻辑（可选）

**步骤**：
```javascript
// 1. 在 storage.js 的 getDefaultData() 中添加
时间花销: {
  // ... 原有字段
  运动: 0,  // 新增
}

// 2. 在 TimeSpend.vue 中添加输入框
<el-form-item label="运动" label-width="100px">
  <el-input-number v-model="localData.运动" />
</el-form-item>

// 3. 更新 totalHours 计算（包含运动）
```

**数据影响**：✅ 旧数据自动兼容（运动=0）

---

### 场景2：修改评分数量（如从5个改为7个）

**需要修改的文件**：
1. `src/utils/storage.js` - 修改评分数组长度
2. `src/components/TimeSpend.vue` - 修改评分显示

**步骤**：
```javascript
// 1. 在 storage.js 中修改
评分: ['💔', '💔', '💔', '💔', '💔', '💔', '💔']  // 7个

// 2. 在 TimeSpend.vue 中更新显示逻辑
// 确保评分数组始终有7个元素
```

**数据影响**：✅ 旧数据自动兼容（自动补齐到7个）

---

### 场景3：添加新的模块（如"学习"模块）

**需要修改的文件**：
1. `src/utils/storage.js` - 添加新模块到默认数据
2. `src/components/` - 创建新组件（如 `StudyModule.vue`）
3. `src/views/Home.vue` - 添加新步骤

**步骤**：
```javascript
// 1. 在 storage.js 中添加
export function getDefaultData() {
  return {
    // ... 原有模块
    学习: {
      学习时长: 0,
      学习内容: '',
      反思: ''
    }
  }
}

// 2. 创建 src/components/StudyModule.vue

// 3. 在 Home.vue 中添加步骤
```

**数据影响**：✅ 旧数据自动兼容（新模块为空）

---

### 场景4：修改表单布局或样式

**需要修改的文件**：
- `src/components/*.vue` - 修改模板和样式
- `src/style.css` - 修改全局样式

**数据影响**：✅ 不影响数据（只改变显示）

---

## 🔧 修改流程

### 1. 确定修改范围
- [ ] 需要添加新字段？
- [ ] 需要修改现有字段？
- [ ] 需要添加新模块？
- [ ] 只修改UI？

### 2. 修改代码
- [ ] 更新 `getDefaultData()`（如果需要）
- [ ] 更新组件（如果需要）
- [ ] 更新导出功能（如果需要）

### 3. 测试
- [ ] 测试新功能
- [ ] 测试旧数据兼容性
- [ ] 测试数据保存和加载

### 4. 部署
- [ ] 构建项目
- [ ] 部署到 GitHub Pages

---

## ⚠️ 重要提醒

### ✅ 安全修改（推荐）
- 添加新字段
- 添加可选字段
- 扩展数组
- 修改UI

### ⚠️ 需要谨慎的修改
- 重命名字段（需要迁移）
- 删除字段（会丢失数据）
- 改变字段类型（需要转换）

---

## 📝 数据兼容性检查清单

修改后，检查：
- [ ] 旧数据能否正常加载？
- [ ] 新字段是否有默认值？
- [ ] 数据保存是否正常？
- [ ] 导出功能是否正常？

---

## 🆘 如果数据出现问题

1. **检查默认数据**：确保 `getDefaultData()` 包含所有字段
2. **检查组件初始化**：确保正确合并旧数据和新字段
3. **查看控制台**：检查是否有错误信息
4. **恢复代码**：如果问题严重，可以回退代码

**记住**：只要遵循"向后兼容"原则，旧数据就不会受影响！

